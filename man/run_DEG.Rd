% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/differential_expression_analysis.R
\name{run_DEG}
\alias{run_DEG}
\title{Run differential expression analysis}
\usage{
run_DEG(
  seuObj,
  groupBy,
  groupIDs = NULL,
  compareBy = NULL,
  compareDF = NULL,
  testUse = "wilcox",
  recorrectUMI = FALSE,
  onlyPos = TRUE,
  assayName = "SCT"
)
}
\arguments{
\item{seuObj}{A Seurat object}

\item{groupBy}{Character string specifying the primary grouping variable}

\item{groupIDs}{Optional character vector of specific groups to analyze}

\item{compareBy}{Optional character string for secondary grouping (e.g., "treatment")}

\item{compareDF}{Optional dataframe with two columns specifying pairwise comparisons}

\item{testUse}{Character string specifying statistical test (default: "wilcox")}

\item{recorrectUMI}{Logical, whether to recorrect UMI counts (default: FALSE)}

\item{onlyPos}{Logical, return only positive markers (default: TRUE)}

\item{assayName}{Character string specifying assay to use (default: "SCT")}
}
\value{
A dataframe containing differential expression results with columns:
\describe{
\item{gene}{Gene name}
\item{p_val}{Unadjusted p-value}
\item{p_val_adj}{Adjusted p-value}
\item{avg_log2FC}{Average log2 fold change}
\item{pct.1}{Percentage of cells expressing in group 1}
\item{pct.2}{Percentage of cells expressing in group 2}
\item{log2pctDiff}{Log2 ratio of pct.1 to pct.2}
}
}
\description{
Performs differential gene expression analysis using Seurat's FindMarkers
or FindAllMarkers functions. Supports both simple cluster comparisons and
complex pairwise comparisons within groups.
}
\details{
Two modes of operation:
\enumerate{
\item Simple mode: When compareBy and compareDF are NULL, runs FindAllMarkers
\item Complex mode: Performs pairwise comparisons specified in compareDF within each group
}
}
